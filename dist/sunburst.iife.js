/* sunburst.js v1.2.1 | (c) SunsetWx, LLC. and other contributors | ISC License */
var SunburstJS=(function(){"use strict";var e={TIMEOUT:30,EXPIRES_IN:604800,SCOPE:["predictions"],CLOCK_SKEW_OFFSET:300,BASE_URL:"https://sunburst.sunsetwx.com/v1"},t=Object.freeze({default:e,__moduleExports:e}),s="Sunburst API client library for Node.js, React Native, and in-browser JavaScript",r={type:"git",url:"git://github.com/sunsetwx/sunburst.js.git"},o="https://github.com/sunsetwx/sunburst.js",n={url:"https://github.com/sunsetwx/sunburst.js/issues"},a={lib:"src/lib"},i={build:"rollup -c",test:"jest --coverage"},u={node:">=6.5",npm:">=5.6.0"},c=[">=0.25%"],p={"./src/lib/encoding/base64/node.js":"./src/lib/encoding/base64/browser.js","./src/lib/request/node.js":"./src/lib/request/browser.js"},l={"babel-core":"^6.26.0","babel-plugin-external-helpers":"^6.22.0","babel-preset-env":"^1.6.1",jest:"^22.4.3",rollup:"^0.58.0","rollup-plugin-babel":"^3.0.3","rollup-plugin-commonjs":"^9.1.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.3.0","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},d={buffer:"^5.1.0"},f=["sunsetwx","api","sunsetwx api","sunburst","sunburst-js","client","client library","javascript","node","node.js","react-native","react native","sunrise","sunset","weather","prediction","geolocation","nature","color","photography","tourism"],h={name:"sunburst.js",version:"1.2.1",description:s,author:"SunsetWx, LLC.",license:"ISC",repository:r,homepage:o,bugs:n,main:"src/index.js",module:"dist/sunburst.esm.js",directories:a,scripts:i,engines:u,browserslist:c,browser:p,devDependencies:l,optionalDependencies:d,keywords:f,"react-native":{"./src/lib/encoding/base64/node.js":"./src/lib/encoding/base64/react-native.js","./src/lib/request/node.js":"./src/lib/request/browser.js"}},m=Object.freeze({name:"sunburst.js",version:"1.2.1",description:s,author:"SunsetWx, LLC.",license:"ISC",repository:r,homepage:o,bugs:n,main:"src/index.js",module:"dist/sunburst.esm.js",directories:a,scripts:i,engines:u,browserslist:c,browser:p,devDependencies:l,optionalDependencies:d,keywords:f,default:h}),b=m&&h||m;const{name:y,version:g}=b,j=[];"undefined"!=typeof navigator&&navigator.userAgent&&j.push(navigator.userAgent),"undefined"!=typeof process&&process.versions&&j.push(Object.keys(process.versions).map(e=>`${e}/${process.versions[e]}`).join(" ")),j.push(`${y}/${g}`);var _=j.join(" "),v=Object.freeze({default:_,__moduleExports:_}),S=class extends Error{constructor(e,t){super(e),this.name="RequestError",this.statusCode=t}},w=Object.freeze({default:S,__moduleExports:S}),E={encode:e=>btoa(e)},O=Object.freeze({default:E,__moduleExports:E}),q={snakeToCamel:e=>e.replace(/_[a-zA-Z]/g,e=>e.toUpperCase().replace("_","")),camelToSnake:e=>e.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`),convertCaseKeys(e,t){if(Array.isArray(e)){const s=[];for(let r=0;r<e.length;r++)null===e[r]||!Array.isArray(e[r])&&"object"!=typeof e[r]?s[r]=e[r]:s[r]=this.convertCaseKeys(e[r],t);return s}if(e&&"object"==typeof e){const s={};return Object.keys(e).forEach(r=>{const o=t(r);null!==e[r]&&"object"==typeof e[r]?s[o]=this.convertCaseKeys(e[r],t):s[o]=e[r]}),s}return e}},x=Object.freeze({default:q,__moduleExports:q});const T=e=>Object.keys(e).map(t=>void 0!==e[t]?encodeURIComponent(t)+"="+encodeURIComponent(e[t]):null).join("&");var k=({uri:e,method:t="GET",headers:s={},qs:r,formData:o,body:n,timeout:a})=>new Promise((i,u)=>{try{n&&(n=JSON.stringify(n),s["content-type"]="application/json; charset=utf-8"),o&&(n=T(o),s["content-type"]="application/x-www-form-urlencoded; charset=utf-8"),r&&(e=`${e}?${T(r)}`)}catch(e){return u(e)}const c=new XMLHttpRequest;c.open(t,e),Object.keys(s).forEach(e=>c.setRequestHeader(e,s[e])),c.onerror=(()=>{if(c.readyState!==XMLHttpRequest.DONE||0!==c.status)return u(new Error(c.statusText||`unknown request error: ${e}`))}),c.onabort=(()=>u(new Error(`request timeout: ${e}`))),c.onload=(()=>i({response:c.response,statusCode:c.status})),a>0&&setTimeout(()=>c.abort(),1e3*a),c.send(n)}),C=Object.freeze({default:k,__moduleExports:k}),D=e=>Array.isArray(e)?e.join(","):"object"==typeof e?e.coordinates.join(","):e,I=Object.freeze({default:D,__moduleExports:D}),z=e=>e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():e,P=Object.freeze({default:z,__moduleExports:z}),$=I&&D||I,A=P&&z||P;const L=e=>(e.geo=$(e.geo),e.after=A(e.after),e);var R={get:L,post:e=>e.map(e=>L(e))},K=R.get,U=R.post,N=Object.freeze({default:R,__moduleExports:R,get:K,post:U}),B={get:e=>(e.geo=$(e.geo),e)},J=B.get,M=Object.freeze({default:B,__moduleExports:B,get:J}),F={quality:N&&R||N,location:M&&B||M},W=F.quality,X=F.location,H=Object.freeze({default:F,__moduleExports:F,quality:W,location:X}),G={params:H&&F||H},Z=G.params,Q=Object.freeze({default:G,__moduleExports:G,params:Z}),V=t&&e||t,Y=v&&_||v,ee=w&&S||w,te=O&&E||O,se=x&&q||x,re=C&&k||C,oe=Q&&G||Q,ne=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,s){return(function r(o,n){try{var a=t[o](n),i=a.value}catch(e){return void s(e)}if(!a.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)})("next")})}},ae=class{constructor(e){const t={clientId:"",clientSecret:"",expiresIn:V.EXPIRES_IN,scope:V.SCOPE,origins:[],addresses:[],token:null,timeout:V.TIMEOUT,clockSkewOffset:V.CLOCK_SKEW_OFFSET,userAgent:Y,baseUrl:V.BASE_URL};this._state=Object.assign({},t,e)}request(e={},t){var s=this;const{path:r,method:o="GET",headers:n={},qs:a,formData:i,body:u}=e;return new Promise((c=ne(function*(c,p){try{t&&(c=t.resolve,p=t.reject);const l={"user-agent":s._state.userAgent};if(!n.authorization){const{accessToken:e}=yield s.getToken({forceRefresh:t});l.authorization=`Bearer ${e}`}const d=yield re({method:o,uri:`${s._state.baseUrl}${r}`,headers:Object.assign({},l,n),qs:se.convertCaseKeys(a,se.camelToSnake),formData:se.convertCaseKeys(i,se.camelToSnake),body:se.convertCaseKeys(u,se.camelToSnake),timeout:s._state.timeout}),f=JSON.parse(d.response);return f.error?401!==d.statusCode||t?p(new ee(f.error,d.statusCode)):s.request(e,{resolve:c,reject:p}):c(se.convertCaseKeys(f,se.snakeToCamel))}catch(e){try{if("number"!=typeof e.statusCode)return p(e);const{error:t}=JSON.parse(e.message);return p(new ee(t||e.message,e.statusCode))}catch(t){return p(e)}}}),function(e,t){return c.apply(this,arguments)}));var c}createSession({email:e,password:t,passcode:s,scope:r,type:o="permanent",params:n={}}){var a,i=this;return new Promise((a=ne(function*(a,u){try{const c={grant_type:"password",scope:r.join(" "),type:o,passcode:s},p=`${e}:${t}`,l=te.encode(p),{session:d}=yield i.request({method:"POST",path:"/login",headers:{authorization:`Basic ${l}`},formData:Object.assign({},c,n)});return d.scope=d.scope.split(" "),a(d)}catch(e){return u(e)}}),function(e,t){return a.apply(this,arguments)}))}getToken({forceRefresh:e,preventStore:t}){var s,r=this;return new Promise((s=ne(function*(s,o){if(!e&&r._state.token&&"object"==typeof r._state.token){const{token:e,clockSkewOffset:t}=r._state,{accessToken:o,expires:n}=e;if(n-1e3*t-(new Date).valueOf()>0)return s({accessToken:o,expires:n})}try{if(!r._state.clientId||!r._state.clientSecret)throw new Error("create a new instance of SunburstJS with both clientId and clientSecret options set");const e=`${r._state.clientId}:${r._state.clientSecret}`,n=te.encode(e),{accessToken:a,expiresIn:i}=yield r.request({method:"POST",path:"/login/session",headers:{authorization:`Basic ${n}`},formData:{grant_type:"client_credentials",expires_in:r._state.expiresIn,scope:r._state.scope.join(" "),origins:r._state.origins.join(" "),addresses:r._state.addresses.join(" ")}}),u=1e3*i+(new Date).valueOf();return t||(r._state.token={accessToken:a,expires:u}),s({accessToken:a,expires:u})}catch(e){return o(e)}}),function(e,t){return s.apply(this,arguments)}))}logout(){var e,t=this;return new Promise((e=ne(function*(e,s){try{const r=yield t.request({method:"POST",path:"/logout"});return t._state.token=null,e(r)}catch(e){return s(e)}}),function(t,s){return e.apply(this,arguments)}))}sessions(e={}){return this.request({path:"/account/sessions",qs:e})}deleteSessionById(e={id:""}){return this.request({method:"DELETE",path:`/account/session/${e.id}`,formData:e})}deleteSessions(e={}){return this.request({method:"DELETE",path:"/account/sessions",formData:e})}account(){return this.request({path:"/account"})}deleteAccount(e={}){return this.request({method:"DELETE",path:"/account",formData:e})}passwordReset(e={}){return this.request({method:"POST",path:"/account/password/reset",formData:e})}updateEmail(e={}){return this.request({method:"POST",path:"/account/email",formData:e})}updateMfa(e={}){return this.request({method:"POST",path:"/account/mfa",formData:e})}totpSecret(){return this.request({path:"/account/mfa/totp"})}mfa(){return this.request({path:"/account/mfa"})}coordinates(e={}){return this.request({path:"/coordinates",qs:e})}location(e={}){return this.request({path:"/location",qs:oe.params.location.get(e)})}quality(e={}){return this.request({path:"/quality",qs:oe.params.quality.get(e)})}batchQuality(e=[]){return this.request({method:"POST",path:"/quality",body:oe.params.quality.post(e)})}},ie=Object.freeze({default:ae,__moduleExports:ae});return ie&&ae||ie})();
